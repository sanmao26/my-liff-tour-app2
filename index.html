<!doctype html>
<html lang="th">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>LIFF Flex on GitHub Pages</title>
    <style>
      :root { color-scheme: light dark; }
      body{font-family: ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
           margin:0; padding:32px; display:grid; place-items:start; gap:16px; max-width:720px}
      header{display:flex; align-items:center; gap:12px}
      h1{font-size:clamp(20px,3.6vw,28px); margin:0}
      .card{border:1px solid #e5e7eb22; border-radius:16px; padding:16px; box-shadow:0 6px 20px #0001}
      button{padding:12px 16px; border-radius:12px; border:0; cursor:pointer; font-weight:600}
      .primary{background:#06c755; color:white}
      .ghost{background:transparent; border:1px solid #cbd5e1}
      code, .mono{font-family: ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono",monospace}
      .row{display:flex; gap:8px; flex-wrap:wrap}
      .hint{opacity:.8; font-size:14px}
    </style>
  </head>
  <body>
    <header>
      <img src="https://scdn.line-apps.com/n/channel_devcenter/img/line-icon-196x196.png" width="36" height="36" alt="LINE">
      <h1>‡πÅ‡∏ä‡∏£‡πå Flex Message ‡∏ú‡πà‡∏≤‡∏ô LIFF (GitHub Pages)</h1>
    </header>

    <div class="card">
      <p>‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö <strong>Share Target Picker</strong>. ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ <span class="mono">LIFF_ID</span> ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏õ‡∏¥‡∏î‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ô‡∏µ‡πâ <strong>‡∏à‡∏≤‡∏Å‡πÉ‡∏ô LINE</strong> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏î‡∏™‡∏≠‡∏ö.</p>
      <div class="row">
        <button id="btnLogin" class="ghost">Log in</button>
        <button id="btnShare" class="primary">Share Flex</button>
        <button id="btnLogout" class="ghost">Log out</button>
      </div>
      <p class="hint" id="env"></p>
      <p class="hint">‡∏´‡∏≤‡∏Å‡∏Å‡∏î‡πÅ‡∏ä‡∏£‡πå‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ô LINE, ‡πÅ‡∏•‡∏∞ LIFF app ‡πÄ‡∏õ‡∏¥‡∏î scope <code>chat_message.write</code>.</p>
    </div>

    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <script>
      const LIFF_ID = "YOUR_LIFF_ID"; // ‚Üê ‡πÉ‡∏™‡πà LIFF ID ‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì

      const $ = (id) => document.getElementById(id);

      function getFlexContent(){
        // ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á Flex Bubble ‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ó‡∏ó‡∏±‡∏ß‡∏£‡πå ‚Äî ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
        return {
          type: "bubble",
          hero: {
            type: "image",
            url: "https://picsum.photos/800/533",
            size: "full",
            aspectRatio: "3:2",
            aspectMode: "cover"
          },
          body: {
            type: "box",
            layout: "vertical",
            spacing: "md",
            contents: [
              { type: "text", text: "PVN-PQC30-VZ ‡∏ü‡∏π‡∏Å‡πä‡∏ß‡∏Å", weight: "bold", size: "lg", wrap: true },
              { type: "text", text: "VIN WONDERS + Sunworld Hon Thom", size: "sm", color: "#6b7280", wrap: true },
              { type: "separator", margin: "md" },
              {
                type: "box", layout: "baseline", spacing: "sm",
                contents: [
                  { type: "text", text: "‡∏£‡∏≤‡∏Ñ‡∏≤", color: "#6b7280", size: "sm", flex: 2 },
                  { type: "text", text: "11,999 ‡∏ö‡∏≤‡∏ó", weight: "bold", size: "md", flex: 5, wrap: true }
                ]
              },
              {
                type: "box", layout: "vertical", margin: "md", spacing: "sm",
                contents: [
                  { type: "text", text: "üå¥ ‡∏ô‡πâ‡∏≥‡∏ó‡∏∞‡πÄ‡∏•‡πÉ‡∏™ ‡∏ß‡∏¥‡∏ß‡∏™‡∏ß‡∏¢‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏°‡∏±‡∏•‡∏î‡∏µ‡∏ü‡∏™‡πå", size: "sm", wrap: true },
                  { type: "text", text: "üé¢ ‡∏£‡∏ß‡∏°‡∏ö‡∏±‡∏ï‡∏£ 2 ‡∏™‡∏ß‡∏ô‡∏™‡∏ô‡∏∏‡∏Å‡∏™‡∏∏‡∏î‡∏°‡∏±‡∏ô‡∏™‡πå", size: "sm", wrap: true }
                ]
              }
            ]
          },
          footer: {
            type: "box",
            layout: "vertical",
            spacing: "md",
            contents: [
              {
                type: "button", style: "primary", color: "#06c755",
                action: { type: "uri", label: "‡∏î‡∏π‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°", uri: "https://example.com/program" }
              },
              {
                type: "button", style: "secondary",
                action: { type: "uri", label: "‡πÅ‡∏ä‡∏ó‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°", uri: "https://lin.ee/" }
              }
            ]
          }
        };
      }

      async function main(){
        try{
          await liff.init({ liffId: 2006670623-loPapVk3 });
        }catch(err){
          alert("liff.init failed: " + (err?.message || err));
          return;
        }

        const inClient = liff.isInClient();
        const loggedIn = liff.isLoggedIn();
        $("env").textContent = `inClient=${inClient} | loggedIn=${loggedIn}`;

        $("btnLogin").onclick = () => liff.login();
        $("btnLogout").onclick = () => { liff.logout(); location.reload(); };

        $("btnShare").onclick = async () => {
          if (!inClient){
            alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ô‡∏µ‡πâ‡∏à‡∏≤‡∏Å‡πÉ‡∏ô LINE ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Share Target Picker");
            return;
          }
          if (!liff.isApiAvailable("shareTargetPicker")){
            alert("‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö shareTargetPicker");
            return;
          }
          try{
            await liff.shareTargetPicker([{
              type: "flex",
              altText: "‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ó‡∏ó‡∏±‡∏ß‡∏£‡πå‡∏™‡∏∏‡∏î‡∏Ñ‡∏∏‡πâ‡∏°!",
              contents: getFlexContent()
            }]);
          }catch(err){
            alert("‡πÅ‡∏ä‡∏£‡πå‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: " + (err?.message || err));
          }
        };

        // UI state
        $("btnLogin").style.display = loggedIn ? "none" : "inline-block";
        $("btnLogout").style.display = loggedIn ? "inline-block" : "none";
        $("btnShare").style.display = "inline-block";
      }

      main();
    </script>
  </body>
</html>
